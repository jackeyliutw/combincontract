



<!DOCTYPE html>
<html>
<head>
    <!-- <script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js@1.0.0-beta.36/dist/web3.min.js" crossorigin="anonymous" integrity="sha256-nWBTbvxhJgjslRyuAKJHK+XcZPlCnmIAAMixz6EefVk="></script> -->
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>


    <meta charset="UTF-8">
  <style>
    body {
  /* background-color: rgba(201, 29, 29, 0); */
  /* color:rgb(48, 99, 211);
  max-width:800px; */
  /* margin: 100px auto 0;
  text-align: center;
  display: table; */
}

.counter {

    color: rgb(255, 255, 255);
     font-size: 200px ; 
     font-family:monospace;

    text-transform: none;
    text-align: center;

  display: table-cell;
  margin:1.5%;
  /* font-size:100px; */
  background-color: rgba(255, 111, 111, 0);
  width:200px;
  border-radius: 50%;
  height:200px;
  vertical-align: middle;


  /* color: #f35626; */
    /* background-image: linear-gradient(92deg, rgb(243, 86, 38) 0%, rgb(254, 171, 58) 100%); */
    /* background-clip: text;
    -webkit-text-fill-color: transparent;
    animation: hue 60s infinite linear; */




  /* font-family:fantasy; */

  /* -webkit-animation:counter .8s cubic-bezier(.215,.61,.355,1.000) both;animation:counter .8s cubic-bezier(.215,.61,.355,1.000) both */

  -webkit-animation:counter 1s linear both;animation:counter 1s linear both;

 

}
/* @-webkit-keyframes counter{0%{letter-spacing:-.5em;-webkit-transform:translateZ(-700px) translateY(-500px);transform:translateZ(-700px) translateY(-500px);opacity:0}40%{opacity:.6}100%{-webkit-transform:translateZ(0) translateY(0);transform:translateZ(0) translateY(0);opacity:1}}@keyframes counter{0%{letter-spacing:-.5em;-webkit-transform:translateZ(-700px) translateY(-500px);transform:translateZ(-700px) translateY(-500px);opacity:0}40%{opacity:.6}100%{-webkit-transform:translateZ(0) translateY(0);transform:translateZ(0) translateY(0);opacity:1}} */

/* .counter{-webkit-animation:counter 1.5s linear both;animation:text-pop-up-top 1.5s linear both} */
/* ----------------------------------------------
 * Generated by Animista on 2020-3-1 17:49:54
 * Licensed under FreeBSD License.
 * See http://animista.net/license for more info. 
 * w: http://animista.net, t: @cssanimista
 * ---------------------------------------------- */

 @-webkit-keyframes counter{0%{-webkit-transform:translateY(0);transform:translateY(0);-webkit-transform-origin:50% 50%;transform-origin:50% 50%;text-shadow:none}100%{-webkit-transform:translateY(-50px);transform:translateY(-50px);-webkit-transform-origin:50% 50%;transform-origin:50% 50%;text-shadow:0 1px 0 #ccc,0 2px 0 #ccc,0 3px 0 #ccc,0 4px 0 #ccc,0 5px 0 #ccc,0 6px 0 #ccc,0 7px 0 #ccc,0 8px 0 #ccc,0 9px 0 #ccc,0 50px 30px rgba(0,0,0,.3)}}
 


 
 

 
 
 @keyframes counter{0%{-webkit-transform:translateY(0);transform:translateY(0);-webkit-transform-origin:50% 50%;transform-origin:50% 50%;text-shadow:none}100%{-webkit-transform:translateY(-50px);transform:translateY(-50px);-webkit-transform-origin:50% 50%;transform-origin:50% 50%;text-shadow:0 1px 0 #ccc,0 2px 0 #ccc,0 3px 0 #ccc,0 4px 0 #ccc,0 5px 0 #ccc,0 6px 0 #ccc,0 7px 0 #ccc,0 8px 0 #ccc,0 9px 0 #ccc,0 50px 30px rgba(0,0,0,.3)}
 
 
 0%{
filter:hue-rotate(0deg);
} 
100%{
filter:hue-rotate(-360deg);
} 
 
 }

 /* @-webkit-keyframes hue {
  from {
    -webkit-filter: hue-rotate(0deg);
  }

  to {
    -webkit-filter: hue-rotate(360deg);
  }
} */
        
        /* ----------------------------------------------
 * Generated by Animista on 2020-3-1 18:24:11
 * Licensed under FreeBSD License.
 * See http://animista.net/license for more info. 
 * w: http://animista.net, t: @cssanimista
 * ---------------------------------------------- */

/* @-webkit-keyframes counter{0%{letter-spacing:-.5em;-webkit-transform:translateZ(-700px) translateY(500px);transform:translateZ(-700px) translateY(500px);opacity:0}40%{opacity:.6}100%{-webkit-transform:translateZ(0) translateY(0);transform:translateZ(0) translateY(0);opacity:1}}@keyframes counter {0%{letter-spacing:-.5em;-webkit-transform:translateZ(-700px) translateY(500px);transform:translateZ(-700px) translateY(500px);opacity:0}40%{opacity:.6}100%{-webkit-transform:translateZ(0) translateY(0);transform:translateZ(0) translateY(0);opacity:1}} */

  </style>
</head>
<body>
    
    <h4 id="h4">輸入暱稱：</h4>
    <h4><input name="欄位名稱" id="nickname" type="text"><br></h4>
    <h4>輸入文件名稱：</h4>
    <h4><input name="欄位名稱" id="filename" type="text"><br></h4>
    <h4>輸入文字：</h4>
    <h4><input name="欄位名稱" id="text"" type="text"><br></h4>
    <button class="btn btn-default" style="margin-top:2%" onclick="recordtext()" type="submit">輸入</button>


<!-- test -->
<p>目前總參與地址:<span id="join_address"></span></p>
<ol id="join_address">

</ol>





<div id="c" class="counter" data-count=>0</div>



<!-- test -->

<!-- 選擇鏈 -->
    <script>
        if (typeof web3 !== 'undefined') {

          web3 = new Web3(web3.currentProvider);
          console.log("existing web3: provider " + typeof web3);
          console.log(web3.currentProvider);
          
          } else {
          // 確認是否使用metamask地址
          //web3 = new Web3(new Web3.providers.HttpProvider("http://localhost:8545"));
          web3 = new Web3(new Web3.providers.HttpProvider("https://rinkeby.infura.io/v3/023b55b06cb04189bffd9f7bdbae18a2"));//test

          alert("Please install metamask");
        }

        var myContract;
        var coinbase;
        var articlenumber; //餐與數


        async function attachcontract () {
          coinbase = await web3.eth.getCoinbase();
          var contract_address = "0x8E6F5D5913cd79517D8FD656d0251DCF7CDd6f2C";//合約位置
          var contract_abi = [{ "anonymous": false, "inputs": [ { "indexed": false, "internalType": "uint256", "name": "articlenumber", "type": "uint256" }, { "indexed": false, "internalType": "address", "name": "author", "type": "address" }, { "indexed": false, "internalType": "string", "name": "nickname", "type": "string" }, { "indexed": false, "internalType": "string", "name": "filename", "type": "string" }, { "indexed": false, "internalType": "string", "name": "text", "type": "string" } ], "name": "recordmsg", "type": "event" }, { "inputs": [ { "internalType": "string", "name": "nickname", "type": "string" }, { "internalType": "string", "name": "filename", "type": "string" }, { "internalType": "string", "name": "text", "type": "string" } ], "name": "submittext", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [], "name": "articlenumber", "outputs": [ { "internalType": "uint256", "name": "", "type": "uint256" } ], "stateMutability": "view", "type": "function" } ]
          myContract = new web3.eth.Contract(contract_abi, contract_address);
          
          var contract_investors = await myContract.methods.articlenumber().call({from: '0x6500111a2fdb8d5d1e0f6ac19988fc7d16201f82'});//from任意地址?

$("#join_address").text(contract_investors);  //發現放進text會出現摻與合約數


            articlenumber = await myContract.methods.articlenumber().call();
        // alert(articlenumber);



        $("#c"). attr("data-count",articlenumber);
      $('.counter').each(function() {
    var $this = $(this),
        countTo = $this.attr('data-count');
    
    $({ countNum: $this.text()}).animate({
      countNum: countTo
    },
  
    {
  
      duration: 5000,  //數幾秒
      easing:'linear',
      step: function() {
        $this.text(Math.floor(this.countNum));
      },
      complete: function() {
        $this.text(this.countNum);
        //alert('finished');
      }
  
    });  
    
    
  
  });


        }
        attachcontract();

//<!-- 紀錄的函式 -->
        
        function recordtext () {
          var nickname = document.getElementById("nickname").value;
          var filename = document.getElementById("filename").value;
          var text = document.getElementById("text").value;
          myContract.methods.submittext(nickname,filename,text).send({ from: coinbase }).then(function (receipt) {alert("成功紀錄文字 upload finished"); });
        }
        


            
    

    
      //var i=articlenumber;    //數到多少
      // $('.counter').
     
    </script>
  
  <script>
    function testAnim(x) {
      $('#animationSandbox').removeClass().addClass(x + ' animated').one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', function(){
        $(this).removeClass();
      });
    };
  
    $(document).ready(function(){
      $('.js--triggerAnimation').click(function(e){
        e.preventDefault();
        var anim = $('.js--animations').val();
        testAnim(anim);
      });
  
      $('.js--animations').change(function(){
        var anim = $(this).val();
        testAnim(anim);
      });
    });
  
  </script>
</body>
</html>



